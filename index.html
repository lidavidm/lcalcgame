<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <title>A game to teach code comprehension</title>

        <!-- Third-party dependencies -->
        <script src="lib/FileSaver.min.js" charset="utf-8"></script>
        <!-- Write a level modal popover -->
        <link rel="stylesheet" href="lib/jquery-ui.min.css" media="screen" charset="utf-8">

        <!-- Loading library (Pace.js) and its style -->
        <link rel="stylesheet" href="lib/pace.css" media="screen" charset="utf-8">
        <script src="lib/pace.min.js"></script>

        <!-- Vis.js library for live state graph visualization.
             NOTE: You can comment this out for production.       -->
        <link rel="stylesheet" href="lib/vis.min.css" media="screen" charset="utf-8">
        <script src="lib/vis.min.js"></script>

        <!-- Audio -->
        <script src="lib/howler.min.js"></script>
        <script src="lib/sm2/js/soundmanager2.js"></script>
        <script src="lib/lowLag.js"></script>

        <!-- JQuery -->
        <script src="lib/jquery.min.js"></script>

        <!-- JQuery UI and Popover -->
        <script src="lib/jquery-ui.min.js" charset="utf-8"></script>
        <script src="lib/jquery-ui.structure.min.css" charset="utf-8"></script>
        <script src="lib/writeALevelPopup.js"></script>
        <script src="lib/progressBar.js"></script>
        <script src="lib/mobile-detect.min.js"></script>

        <!-- Parsers -->
        <script src="lib/esprima.js"></script>
        <script src="lib/escodegen.js"></script>
        <script src="build/frame/parseES6.js"></script>

        <!-- Game dependencies -->
        <script src="build/util.js" charset="utf-8"></script> <!-- shared utility functions -->
        <script src="build/log/logger.js" charset="utf-8"></script> <!-- data logging -->
        <script src="build/unit/test.js" charset="utf-8"></script> <!-- unit testing -->
        <script src="build/core/node.js" charset="utf-8"></script>
        <script src="build/core/shapes.js" charset="utf-8"></script>
        <script src="build/core/image.js" charset="utf-8"></script>
        <script src="build/core/animate.js" charset="utf-8"></script>
        <script src="build/core/resource.js" charset="utf-8"></script>
        <script src="build/core/environment.js" charset="utf-8"></script>
        <script src="build/core/network.js" charset="utf-8"></script>
        <script src="build/core/stage.js" charset="utf-8"></script>
        <script src="build/misc/syntax.js" charset="utf-8"></script>
        <script src="build/misc/bag.js" charset="utf-8"></script>
        <script src="build/misc/arrowpath.js" charset="utf-8"></script>
        <script src="build/misc/rainbowtrail.js" charset="utf-8"></script>
        <script src="build/expr/expression.js" charset="utf-8"></script>
        <script src="build/frame/environmentdisplay.js" charset="utf-8"></script>
        <script src="build/frame/progressmanager.js" charset="utf-8"></script>
        <script src="build/frame/syntax_journal.js" charset="utf-8"></script>
        <script src="build/expr/notch.js" charset="utf-8"></script>
        <script src="build/expr/apply.js" charset="utf-8"></script>
        <script src="build/expr/give.js" charset="utf-8"></script>
        <script src="build/expr/value.js" charset="utf-8"></script>
        <script src="build/expr/bool.js" charset="utf-8"></script>
        <script src="build/expr/clamp.js" charset="utf-8"></script>
        <script src="build/expr/collection.js" charset="utf-8"></script>
        <script src="build/expr/compare.js" charset="utf-8"></script>
        <script src="build/expr/conditional.js" charset="utf-8"></script>
        <script src="build/expr/define.js" charset="utf-8"></script>
        <script src="build/expr/entangled.js" charset="utf-8"></script>
        <script src="build/expr/missing.js" charset="utf-8"></script>
        <script src="build/expr/lambda.js" charset="utf-8"></script>
        <script src="build/expr/null.js" charset="utf-8"></script>
        <script src="build/expr/meta.js" charset="utf-8"></script>
        <script src="build/expr/number.js" charset="utf-8"></script>
        <script src="build/expr/text.js" charset="utf-8"></script>
        <script src="build/expr/error.js" charset="utf-8"></script>
        <script src="build/expr/recall.js" charset="utf-8"></script>
        <script src="build/expr/obj.js" charset="utf-8"></script>
        <script src="build/expr/var.js" charset="utf-8"></script>
        <script src="build/expr/vardisplay.js" charset="utf-8"></script>
        <script src="build/expr/sequence.js" charset="utf-8"></script>
        <script src="build/expr/loops.js" charset="utf-8"></script>
        <script src="build/expr/choice.js" charset="utf-8"></script>
        <script src="build/expr/snappable.js" charset="utf-8"></script>
        <script src="build/expr/string.js" charset="utf-8"></script>
        <script src="build/expr/func.js" charset="utf-8"></script>
        <script src="build/expr/tree.js" charset="utf-8"></script>
        <script src="build/fx/effect.js" charset="utf-8"></script>
        <script src="build/func/func.js" charset="utf-8"></script>
        <script src="build/func/map.js" charset="utf-8"></script>
        <script src="build/func/count.js" charset="utf-8"></script>
        <script src="build/frame/toolbox.js" charset="utf-8"></script>
        <script src="build/frame/loadresources.js" charset="utf-8"></script>
        <script src="build/frame/reductstage.js" charset="utf-8"></script>
        <script src="build/frame/game.js" charset="utf-8"></script>
        <script src="build/frame/menus.js" charset="utf-8"></script>
        <script src="build/frame/exprmanager.js" charset="utf-8"></script>
        <script src="build/init.js" charset="utf-8"></script>

        <!-- <script src="bundle/reduct.js" charset="utf-8"></script> -->
        <style media="screen">
            body {
                min-width: 840px;
                min-height: 700px;
                margin-left: 0;
                margin-right: 0;
            }
            #canvas {
                padding: 0;
                margin-left: auto;
                margin-right: auto;
                display: block;
            }
            #canvasWrapper {
                padding: 0;
                margin-left: auto;
                margin-right: auto;
                display: block;
                width: 800px;
                height: 600px;
            }
            #stateGraphCanvas {
                padding: 0;
                position: absolute;
                left: 0;
                top: 0;
                width:400px;
                height:400px;
                /*border: 1px solid blue;*/
                background: #111;
            }
            #progressBarContainer {
                display: block;
                width:800px;
                height:4px;
                background-color: white;
            }
            #lvl_num_visible_box {
                color:gray;
            }
            #chap_name_box {
                color:lightgray;
            }
            #progressBar {
                display: block;
                width:5px;
                height:100%;
                background-color: gold;
            }
            .textOverlay {
                font-family: Arial, sans-serif;
            }
            #endscreen {
                position: absolute;
                display: none;
            }
            .blendedlink {
                color: inherit;
            }
            #help {
                position: absolute;
                display: none;

                -moz-user-select: none;
               -khtml-user-select: none;
               -webkit-user-select: none;
                user-select: none;
                cursor: default;
                pointer-events: none;
            }
            #footer {
                padding: 1rem;
                color: #aaa;
                font-size: 1em;
                text-align: center;
            }
            .textOverlay > h1 {
                color: Salmon;
            }
            .centered {
                padding: 0;
                margin-left: auto;
                margin-right: auto;
                width: 100%;
                display: block;
                text-align: center;
            }
            #type_help {
                position: relative;
                top: -160px;
                left: -20px;
                color: gray;

                display: none;

                -moz-user-select: none;
               -khtml-user-select: none;
               -webkit-user-select: none;
                user-select: none;
                cursor: default;
                pointer-events: none;
            }
            .right {
                padding: 0;
                display: block;
                text-align: right;
            }
            .shadow {
               -moz-box-shadow:    inset 0 0 10px #000000;
               -webkit-box-shadow: inset 0 0 10px #000000;
               box-shadow:         inset 0 0 10px #000000;
            }
            .expr_input {
                font-family: Consolas, sans-serif;
            }
            @media screen and (max-width: 1024px) {
                body {
                    min-width: auto;
                    min-height: auto;
                    margin: 0;
                }

                #devinfo {
                    overflow: scroll;
                }
            }
        </style>
    </head>

    <body onload="init()" bgcolor="#594764">

        <!-- <div id="progressBarContainer" class="centered shadow">
            <div id="progressBar">
            </div>
        </div> -->

        <div id="canvasContainer">
            <div id="canvasWrapper">
                <canvas id="canvas" onmousedown="" width="800" height="600" style="background-color:#534764;"></canvas>
                <div id="type_help" class="textOverlay right">
                    <h3><span style="color:#aaa">Hint:</span><br /><span id="hint">== or +</span></h3>
                </div>
            </div>
            <div id="stateGraphCanvas"></div>
            <div id="help" class="textOverlay centered">
                <h3 id="help_text">Drop the "A" into the leftmost x.</h3>
            </div>
            <div id="endscreen" class="textOverlay centered">
                <h1>Thanks for playing!</h1>
                <p>
                    If you have any feedback or questions, <br /> contact us at iaa32 - at - cornell.edu
                </p>
            </div>
        </div>

        <br />

        <div class="centered" id="lvl_num_visible_box">
            <!-- <button type="button" name="toJavaScript" onclick="__TEST();">toJavaScript()</button> -->
            Level #<span id="lvl_num_visible">1</span>
            / <span id="lvl_max_num_visible"></span>
        </div>

        <div class="centered" id="chap_name_box">
            Chapter: <span id="chap_name"></span>
        </div>

        <!-- <div id="explanation" class="centered">
            <p>
                Drop expressions into <span style="color:#666;">holes</span> inside other expressions. <br />
                If an expression blinks <span style="color:ForestGreen;">green</span>, click it to reduce.
            </p>
        </div> -->

        <div class="centered">
            <p><button type="button" name="logdl" onclick="Logger.download()">Download LOG Data</button></p>
            <p><button type="button" name="button" onclick="toggleDevInfo()">Show dev info</button></p>
        </div>

        <div id="devinfo">

            <div class="centered" id="variants_div">
               <input type="radio" id="block_variant" name="variant" value="block_variant"> Blocks-only
               <input type="radio" id="verbatim_variant" name="variant" value="verbatim_variant"> Verbatim Typing
               <input type="radio" id="typing_variant" name="variant" value=""> Constructive Typing
            </div>

            <div class="centered" id="evalmode_div">
               <input type="radio" name="evalmode" value="bigStep" checked> Big-Step ⇓
               <input type="radio" name="evalmode" value="manyStep"> Many-step →<sup>*</sup>
               <input type="radio" name="evalmode" value="smallStep"> Small-step →
            </div>

            <div class="centered">
              <select id="chapterSelect">
              </select>
            </div>

            <div id="duplicate_buttons" class="centered">
                <button onclick="prev()">Prev</button>
                <!-- <button onclick="initBoard()">Reset</button> -->
                <button onclick="Logger.clearStoredStaticLogs(); resetToLevel(0); ProgressManager.resetProgress(); initMainMenu()">Reset Completely</button>
                <button onclick="toggleMute()">Mute</button>
            </div>

            <div class="centered">
                <!-- <button onclick="toggleFading()">Fading: <span id="fade_status">ON</span></button> -->
                <button onclick="UnitTest.run(stage)">Run Unit Tests</button>
            </div>

        </div>

        <div class="centered">
            <!-- <p>
                <button id="writeALevel">Write your own level!</button>
            </p> -->

            <div id="write-level-form" title="Write a level" style="display:none;">
              <p class="validateTips">Refer to <a href="writing_levels.html" target="blank">this sheet</a> for more info.</p>

              <form>
                <fieldset>
                  <label for="name">Board:</label>
                  <input type="text" name="name" id="level_expr_input" value="(λx #x) (star)" class="expr_input" size="45"> <br />
                  <label for="email">Goal:</label>
                  <input type="text" name="email" id="goal_expr_input" value="(star)" class="expr_input" size="45"><br />
                  <label for="toolbox">Toolbox:</label>
                  <input type="text" name="toolbox" id="toolbox_expr_input" value="" class="expr_input" size="45">

                  <!-- Allow form submission with keyboard without duplicating the dialog button -->
                  <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
                </fieldset>
              </form>

              <p>
                  Or upload a JSON spec for a new chapter: <input id="add_chapter_json" value="" type="file" />
              </p>

            </div>
        </div>





        <div id="footer">

            <span style="color:#777;">If you encounter a bug, you can click <a href="#" onclick="next()" class="blendedlink">here</a> to skip to the next level.</span>

            <br> <br>

            <div class="centered" style="max-width:400px">
                Privacy disclaimer: We will use your usage statistics to further the improvement of the game (for science!). <br> <a href="#" onclick="toggleLogging()" id="toggleLogLink" class="blendedlink">Click here you'd prefer to turn data logging off.</a>
            </div>

            <br>
            Copyright © 2016 Cornell University Educational Technology Lab. <br> Prototype by <a href="http://ianarawjo.therottingcartridge.com/about/" class="blendedlink" target="_blank">Ian Arawjo</a>. <br> <a href="mailto:iaa32@cornell.edu?Subject=Reduct" class="blendedlink">Contact us @ iaa32 -at- cornell.edu</a>
        </div>
    </body>
</html>
